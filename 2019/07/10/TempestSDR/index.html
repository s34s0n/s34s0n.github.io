<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RFThis dissertation presents a software toolkit for remotely eavesdropping video monitors using a Software De">
<meta name="keywords" content="HackRF,SDR,Tempest">
<meta property="og:type" content="article">
<meta property="og:title" content="TempestSDR">
<meta property="og:url" content="https://s34s0n.github.io/2019/07/10/TempestSDR/index.html">
<meta property="og:site_name" content="HandsOn Security">
<meta property="og:description" content="TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RFThis dissertation presents a software toolkit for remotely eavesdropping video monitors using a Software De">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://gitlab.com/s34s0n/keep/raw/master/images/t1.png">
<meta property="og:image" content="https://gitlab.com/s34s0n/keep/raw/master/images/t2.png">
<meta property="og:image" content="https://gitlab.com/s34s0n/keep/raw/master/images/t3.png">
<meta property="og:updated_time" content="2019-07-09T22:34:58.997Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TempestSDR">
<meta name="twitter:description" content="TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RFThis dissertation presents a software toolkit for remotely eavesdropping video monitors using a Software De">
<meta name="twitter:image" content="https://gitlab.com/s34s0n/keep/raw/master/images/t1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>TempestSDR</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/s34s0n">Projects</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/06/21/Learning-with-DVRF/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://s34s0n.github.io/2019/07/10/TempestSDR/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&text=TempestSDR"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&is_video=false&description=TempestSDR"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=TempestSDR&body=Check out this article: https://s34s0n.github.io/2019/07/10/TempestSDR/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&name=TempestSDR&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TempestSDR-An-SDR-tool-for-Eavesdropping-on-Computer-Screens-via-Unintentionally-Radiated-RF"><span class="toc-number">1.</span> <span class="toc-text">TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Practical-Attack"><span class="toc-number">1.1.</span> <span class="toc-text">Practical Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Set-up"><span class="toc-number">1.1.1.</span> <span class="toc-text">Set-up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Attack"><span class="toc-number">1.1.2.</span> <span class="toc-text">Attack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.2.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        TempestSDR
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">HandsOn Security</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-07-09T22:06:12.000Z" itemprop="datePublished">2019-07-10</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Tools-Techniques/">Tools & Techniques</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/HackRF/">HackRF</a>, <a class="tag-link" href="/tags/SDR/">SDR</a>, <a class="tag-link" href="/tags/Tempest/">Tempest</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="TempestSDR-An-SDR-tool-for-Eavesdropping-on-Computer-Screens-via-Unintentionally-Radiated-RF"><a href="#TempestSDR-An-SDR-tool-for-Eavesdropping-on-Computer-Screens-via-Unintentionally-Radiated-RF" class="headerlink" title="TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RF"></a>TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RF</h1><p>This dissertation presents a software toolkit for remotely eavesdropping video monitors using a Software Defined Radio (SDR) receiver. It exploits compromising emanations from cables carrying video signals.</p>
<p>Raster video is usually transmitted one line of pixels at a time, encoded as a varying current. This generates an electromagnetic wave that can be picked up by an SDR receiver. The software maps the received field strength of a pixel to a gray-scale shade in real-time. This forms a false color estimate of the original video signal.</p>
<p>The toolkit uses unmodified off-the-shelf hardware which lowers the costs and increases mobility compared to existing solutions. It allows for additional post-processing which improves the signal-to-noise ratio. The attacker does not need to have prior knowledge about the target video display. All parameters such as resolution and refresh rate are estimated with the aid of the software.</p>
<p>The software consists of a library written in C, a collection of plug-ins for various Software Defined Radio (SDR) front-ends and a Java-based Graphical User Interface (GUI). It is a multi-platform application, with all native libraries pre-compiled and packed into a single Java jar file.</p>
<h2 id="Practical-Attack"><a href="#Practical-Attack" class="headerlink" title="Practical Attack"></a>Practical Attack</h2><p>The demonstration is undertaken in controlled conditions. However, in order to make it as similar to a real-world attack as possible, we will assume the adversary has no knowledge of the victim’s system. We will estimate the frequency at which the emission strength peaks. We will then analyze the signal to detect the resolution and refresh rate of the screen. We will afterward lock onto the signal and try to recover the original video.</p>
<h3 id="Set-up"><a href="#Set-up" class="headerlink" title="Set-up"></a>Set-up</h3><p>The choice for a front-end for this demonstration is a HackRF. Depending on the particular requirements, an attacker might prefer mobility over accuracy and choose the smaller Mirics FlexiTVTMMSi3101 USB Dongle. However, for this demonstration, we will attempt to obtain the highest possible resolution. Therefore we need a radio that is capable of obtaining a wide bandwidth. This makes the 32 MHz of bandwidth that the USRP provides a much better choice. </p>
<p>For an antenna, we will choose the portable ANT500 - The Telescopic Antenna for HackRF. For better reception from a longer distance, a suitable log-periodic antenna, an amplifier, and a band-pass filter could be used for preconditioning. This can make the system less portable. However, the ANT500 antenna is a cheaper choice and in the end, did the required job.</p>
<h3 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h3><p><img src="https://gitlab.com/s34s0n/keep/raw/master/images/t1.png" alt="Figure 4.1"><br>We now take the place of the adversary that has set up their system, connected the SDR to the laptop and the antenna to the SDR and launch the JTempest.jar executable. We should now see the “Start” button becoming active. Once we press on the button, the system will start processing the data sampled by the HackRF.</p>
<p>If we knew the resolution, frame-rate and the frequency at which the emanations from the target occur, we could enter them directly into the GUI and the story would end here. However, since we don’t, we need to estimate them. That’s why we started with a low sampling rate (8 MHz). Such mode will not be good for actual eavesdropping since it will not provide the full resolution, however, this will allow for improved interactivity and for faster autocorrelation results.</p>
<p>The interface of the program. The “A” button will enable the frame-rate tracking feature. The “Auto” button will attempt to detect synchronization regions. The “AUT” button will try to automatically detect the resolution and line rate (video height). The scale on the right of the video shows in realtime the grey-scale values that map to a particular sample<br>intensity.</p>
<p>First, we need to estimate the frequency at which the emanations from the target peak. To do that we need to keep an eye on the autocorrelation plot and keep changing the frequency until a promising signal appears. There would be a lot of background signals so this would be challenging. However, most video displays run at known refresh rates of 60 Hz, 75 Hz or 71 Hz. If we spot a signal near these values, then we know we are on to something. Figure 4.2 shows that there might be a possible signal onto the current frequency of 125 MHz.</p>
<p><img src="https://gitlab.com/s34s0n/keep/raw/master/images/t2.png" alt="Figure 4.2"><br>In order to set the video parameters to the frequencies in those spikes, we just need to click with the mouse on top of them. We can inspect the frequency at a certain position by hovering the mouse on top. Once we select the best candidate for the refresh rate, we can now choose the best candidate for the line rate as well. This defines the height of the video frame. Note that we can try the “AUT” button which will simply choose the highest values of the two plots. However, when the signal-to-noise ratio is low, other repeating signals on the same frequency may be more prominent so the manual adjustment would be required. The autocorrelation plots are interactive and the user can zoom with the mouse wheel and pan around for choosing small details in the plots. Now we click on the 60.3 fps spike on the top plot and the 628 px spike on the bottom one.</p>
<p><img src="https://gitlab.com/s34s0n/keep/raw/master/images/t3.png" alt="Figure 4.3"><br>If we turn on the “Lpass” averaging, we will get rid of most of the noise and improve the signal-to-noise ratio bringing up the weak video signal. We can clearly see the synchronization pulses. We are also only seeing rapid changes in colors, so we know this is an analog signal. Digital signals will also show activity in regions that have constant intensities. That’s why digital signals could be eavesdropped easier – they emit more energy because of the sharp edges of the individual bits. However, we are apparently dealing with a VGA signal with resolution 800 × 600 @ 60. Note that the system auto-detected it (it shows up in the list underneath the “Stop” button).</p>
<p>We see another autocorrelation peak at 61 Hz. This is aliasing due to the two strong synchronization lines that appear in the video (you can see them on the left). By clicking on the other peak, we can indeed confirm our suspicion that it is just aliasing. Now that we have a signal, we can try to improve it. Since the signal is strongly polarized, changing the antenna angle and position can have a dramatic effect on the end result. Now we can increase the sampling rate of the HackRF to improve the resolution of the obtained image.<br><br></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>If we obtain a good enough signal, we can reconstruct text from the screen.</p>
<p>This shows that a practical attack is possible even from an adversary on a low budget with very little knowledge of the DSP. We also demonstrated that we can deduce the video parameters of a screen remotely in a real-world environment. A more sophisticated attacker could use better equipment with a lower noise floor and higher antenna gain to undertake such an attack from an even further distance. This should open the discussion about what could be done to prevent compromising emanations leaking from cables.<br><br></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/s34s0n">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TempestSDR-An-SDR-tool-for-Eavesdropping-on-Computer-Screens-via-Unintentionally-Radiated-RF"><span class="toc-number">1.</span> <span class="toc-text">TempestSDR: An SDR tool for Eavesdropping on Computer Screens via Unintentionally Radiated RF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Practical-Attack"><span class="toc-number">1.1.</span> <span class="toc-text">Practical Attack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Set-up"><span class="toc-number">1.1.1.</span> <span class="toc-text">Set-up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Attack"><span class="toc-number">1.1.2.</span> <span class="toc-text">Attack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.2.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://s34s0n.github.io/2019/07/10/TempestSDR/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&text=TempestSDR"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&is_video=false&description=TempestSDR"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=TempestSDR&body=Check out this article: https://s34s0n.github.io/2019/07/10/TempestSDR/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&title=TempestSDR"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://s34s0n.github.io/2019/07/10/TempestSDR/&name=TempestSDR&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Season Cherian
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/s34s0n">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-142416047-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 's34s0n-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
